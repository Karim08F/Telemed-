<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Doctor Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 0;
      background-color: #f8fafc;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      color: #2e3a59;
    }
    .container { max-width: 1100px; }
    h2 { font-weight: 700; color: #004080; }
    .card { border-radius: 12px; border: none; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
    .card-title { font-weight: 600; color: #333; }
    .list-group-item { border: none; border-bottom: 1px solid #eee; background: #fdfdfd; }
    .list-group-item:last-child { border-bottom: none; }
    .btn-primary { background-color: #6a5acd; border-color: #6a5acd; border-radius: 6px; font-weight: 500; }
    .btn-primary:hover { background-color: #5a4abb; border-color: #5a4abb; }
    .btn-secondary { background-color: #e0e0e0; color: #333; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="container py-4">
    <h2 class="mb-4">üë®‚Äç‚öïÔ∏è Welcome, Dr. {{ doctor_name }}</h2>

    <!-- Assigned Patients -->
    <div class="card p-3 mb-4">
      <h5 class="card-title">Assigned Patients</h5>
      <ul class="list-group">
        {% for patient in patients %}
          <li class="list-group-item">
            <div class="d-flex justify-content-between">
              <div>
                <strong>{{ patient.name }}</strong><br>
                <small class="text-muted">Email: {{ patient.email }}</small>
              </div>
              <a href="/recommend/{{ patient.patient_id }}" class="btn btn-primary btn-sm">Give Recommendation</a>
            </div>

            <!-- Patient Logs -->
            <div class="mt-2">
              <h6>üìù Recent Logs</h6>
              {% if patient_logs[patient.patient_id] %}
                <ul class="list-group">
                  {% for log in patient_logs[patient.patient_id] %}
                    <li class="list-group-item small">
                      <strong>{{ log.date }}</strong> <br>
                      Symptoms: {{ log.symptoms }} <br>
                      Medications: {{ log.medication }}
                    </li>
                  {% endfor %}
                </ul>
              {% else %}
                <p class="text-muted">No logs yet.</p>
              {% endif %}
            </div>
          </li>
        {% else %}
          <li class="list-group-item text-muted">No patients assigned.</li>
        {% endfor %}
      </ul>
    </div>

    <!-- Pending Appointments -->
    <div class="card p-3 mb-4">
      <h5 class="card-title">üìÖ Pending Appointments</h5>
      <ul class="list-group">
        {% for app in appointments %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ app.patient_name }}</strong><br>
              <small class="text-muted">{{ app.date }}</small>
            </div>
            <div>
              <a href="/appointments/accept/{{ app.id }}" class="btn btn-success btn-sm">Accept</a>
              <a href="/appointments/reject/{{ app.id }}" class="btn btn-danger btn-sm">Reject</a>
            </div>
          </li>
        {% else %}
          <li class="list-group-item text-muted">No pending appointments.</li>
        {% endfor %}
      </ul>
    </div>

    <a href="/logout" class="btn btn-secondary">Logout</a>
  </div>
</body>
</html>
